{
  "id": "snapshot_1764279527405_fdiisgwah",
  "approvalId": "approval_1764279407001_ghdqz124o",
  "approvalTitle": "Project Structure - Honeycomb One Pass",
  "version": 2,
  "timestamp": "2025-11-27T21:38:47.405Z",
  "trigger": "approved",
  "status": "pending",
  "content": "# Project Structure\n\n## Directory Organization\n\n```\nhoneycomb-one-pass/\n├── lib/                          # Main application source\n│   ├── main.dart                 # App entry point\n│   ├── app.dart                  # App configuration and routing\n│   │\n│   ├── core/                     # Core utilities and shared code\n│   │   ├── logging/              # Structured logging (JSON format)\n│   │   ├── constants/            # App-wide constants\n│   │   └── utils/                # Common utility functions\n│   │\n│   ├── domain/                   # Business logic (framework-independent)\n│   │   ├── models/               # Data models (HexCell, Level, GameState)\n│   │   ├── services/             # Game logic services\n│   │   │   ├── level_generator.dart    # Level generation algorithm\n│   │   │   ├── level_validator.dart    # Solvability validation\n│   │   │   ├── path_validator.dart     # Path/move validation\n│   │   │   └── game_engine.dart        # Core game state machine\n│   │   └── repositories/         # Data access interfaces\n│   │\n│   ├── data/                     # Data layer implementation\n│   │   ├── local/                # Local storage (levels, progress)\n│   │   └── remote/               # Future: leaderboard API\n│   │\n│   ├── presentation/             # UI layer\n│   │   ├── screens/              # Full-page screens\n│   │   │   ├── game/             # Game play screen\n│   │   │   ├── level_select/     # Level selection screen\n│   │   │   └── settings/         # Settings screen\n│   │   ├── widgets/              # Reusable UI components\n│   │   │   ├── hex_grid/         # Hexagonal grid rendering\n│   │   │   ├── path_painter/     # Path visualization\n│   │   │   └── effects/          # Visual effects (celebrations)\n│   │   └── providers/            # State management (Riverpod)\n│   │\n│   └── debug/                    # AI Agent debug layer\n│       ├── api/                  # REST API endpoints\n│       │   ├── server.dart       # HTTP server setup\n│       │   ├── game_routes.dart  # Game state endpoints\n│       │   └── level_routes.dart # Level generation endpoints\n│       └── cli/                  # CLI commands\n│           ├── cli_runner.dart   # CLI entry point\n│           ├── generate_cmd.dart # Level generation command\n│           └── validate_cmd.dart # Level validation command\n│\n├── bin/                          # Executable entry points\n│   ├── main.dart                 # Flutter app entry\n│   └── cli.dart                  # CLI tool entry\n│\n├── test/                         # Test files (mirrors lib/ structure)\n│   ├── domain/                   # Unit tests for business logic\n│   ├── data/                     # Data layer tests\n│   ├── presentation/             # Widget tests\n│   └── debug/                    # API/CLI tests\n│\n├── integration_test/             # End-to-end tests\n│\n├── assets/                       # Static assets\n│   ├── sounds/                   # Sound effects\n│   └── fonts/                    # Custom fonts (if any)\n│\n├── scripts/                      # Development scripts\n│   ├── pre_commit.dart           # Pre-commit validation\n│   └── code_metrics.dart         # Code metrics checker\n│\n└── docs/                         # Documentation (minimal)\n    └── api/                      # Generated API docs\n```\n\n## Naming Conventions\n\n### Files\n- **Dart files**: `snake_case.dart` (e.g., `level_generator.dart`, `hex_grid.dart`)\n- **Test files**: `[filename]_test.dart` (e.g., `level_generator_test.dart`)\n- **Widgets**: `snake_case.dart` matching class name (e.g., `hex_cell_widget.dart` for `HexCellWidget`)\n\n### Code\n- **Classes/Types**: `PascalCase` (e.g., `HexCell`, `GameState`, `LevelGenerator`)\n- **Functions/Methods**: `camelCase` (e.g., `generateLevel`, `validatePath`)\n- **Constants**: `camelCase` for local, `SCREAMING_CASE` for global (e.g., `maxGridSize`, `MAX_CHECKPOINTS`)\n- **Variables**: `camelCase` (e.g., `currentLevel`, `pathSegments`)\n- **Private members**: `_camelCase` (e.g., `_internalState`)\n\n## Import Patterns\n\n### Import Order\n1. Dart SDK imports (`dart:`)\n2. Flutter imports (`package:flutter/`)\n3. External packages (`package:`)\n4. Internal packages (`package:honeycomb_one_pass/`)\n5. Relative imports (`./`, `../`)\n\n### Module Organization\n```dart\n// Preferred: Absolute imports for cross-module references\nimport 'package:honeycomb_one_pass/domain/models/hex_cell.dart';\n\n// Acceptable: Relative imports within same feature\nimport '../widgets/hex_cell_widget.dart';\n```\n\n## Code Structure Patterns\n\n### Module/Class Organization\n```dart\n// 1. Imports (ordered as above)\n// 2. Part directives (if using)\n// 3. Constants\n// 4. Type definitions / Enums\n// 5. Main class/function\n// 6. Helper classes (private)\n```\n\n### Function Organization\n```dart\n// 1. Guard clauses / Input validation (fail fast)\n// 2. Core logic\n// 3. Return statement\n```\n\n### File Organization Principles\n- One primary class per file (+ related private helpers)\n- File name matches primary class name in snake_case\n- Keep related code together, but split when approaching 500 lines\n\n## Code Organization Principles\n\n1. **Single Responsibility**: Each file has one clear purpose\n2. **Modularity**: Domain logic is completely independent of UI\n3. **Testability**: All business logic testable without Flutter\n4. **Consistency**: Follow established patterns in codebase\n\n## Module Boundaries\n\n```\n┌─────────────────────────────────────────────────────────────┐\n│                      presentation/                          │\n│  (Depends on: domain, core)                                 │\n│  - Can import: domain/models, domain/services, core/*       │\n│  - Cannot import: data/, debug/                             │\n└─────────────────────────────────────────────────────────────┘\n                              │\n                              ▼\n┌─────────────────────────────────────────────────────────────┐\n│                        domain/                               │\n│  (Depends on: core only)                                    │\n│  - Framework-independent business logic                      │\n│  - No Flutter imports allowed                                │\n│  - Testable with pure Dart                                   │\n└─────────────────────────────────────────────────────────────┘\n                              │\n                              ▼\n┌─────────────────────────────────────────────────────────────┐\n│                         core/                                │\n│  (No internal dependencies)                                  │\n│  - Logging, constants, pure utilities                        │\n│  - No Flutter imports (except for core Flutter utilities)    │\n└─────────────────────────────────────────────────────────────┘\n\n┌─────────────────────────────────────────────────────────────┐\n│                        debug/                                │\n│  (Depends on: domain, core)                                 │\n│  - REST API and CLI for AI agent interaction                 │\n│  - Isolated from presentation layer                          │\n│  - Can be excluded from production builds                    │\n└─────────────────────────────────────────────────────────────┘\n```\n\n**Dependency Rules**:\n- `domain/` → imports only `core/`\n- `presentation/` → imports `domain/` and `core/`\n- `data/` → imports `domain/` (for interfaces) and `core/`\n- `debug/` → imports `domain/` and `core/`\n- **Never**: `domain/` imports from `presentation/`, `data/`, or `debug/`\n\n## Code Size Guidelines\n\n| Metric | Limit | Rationale |\n|--------|-------|-----------|\n| **File size** | Max 500 lines (excluding comments/blanks) | Enforced by pre-commit |\n| **Function size** | Max 50 lines (excluding comments/blanks) | Enforced by pre-commit |\n| **Cyclomatic complexity** | Max 10 per function | Enforced by dart_code_metrics |\n| **Nesting depth** | Max 4 levels | Readability |\n| **Parameters** | Max 5 per function | Consider object parameter if more |\n\n## Debug/API Structure\n\n### REST API Endpoints\n```\nGET  /api/game/state           → Current game state JSON\nPOST /api/game/move            → Execute move, returns new state\nPOST /api/game/reset           → Reset current level\nGET  /api/level/list           → List available levels\nGET  /api/level/:id            → Get level definition\nPOST /api/level/generate       → Generate new level\nPOST /api/level/validate       → Validate level solvability\n```\n\n### CLI Commands\n```\n$ honeycomb-cli generate --size 6 --checkpoints 4    # Generate level\n$ honeycomb-cli validate --file level.json           # Validate level\n$ honeycomb-cli solve --file level.json              # Find solution\n$ honeycomb-cli test --all                           # Run all validations\n```\n\n## Documentation Standards\n- Public APIs: dartdoc comments required\n- Complex algorithms: Inline comments explaining approach\n- No README files per module (keep it simple - KISS)\n- API documentation auto-generated via dartdoc\n",
  "fileStats": {
    "size": 10566,
    "lines": 216,
    "lastModified": "2025-11-27T21:36:43.123Z"
  },
  "comments": []
}